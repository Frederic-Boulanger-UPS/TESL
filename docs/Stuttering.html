<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Theory Stuttering (Isabelle2018: August 2018)</title>
<link media="all" rel="stylesheet" type="text/css" href="isabelle.css"/>
</head>

<body>
<div class="head"><h1>Theory Stuttering</h1>

<span class="command">theory</span> <span class="name">Stuttering</span><br/>
<span class="keyword">imports</span> <a href="StutteringLemmas.html"><span class="name">StutteringLemmas</span></a><br/>

</div>
<div class="source">
<pre class="source"><span class="keyword1"><span class="command">subsection</span></span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Main Theorems&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">theory</span></span><span> </span><span>Stuttering</span><span>
</span><span class="keyword2"><span class="keyword">imports</span></span><span> </span><span>StutteringLemmas</span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">begin</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;
  Using the lemmas of the previous section about the invariance by stuttering
  of various properties of TESL specifications, we can now prove that the atomic 
  formulae that compose TESL specifications are invariant by stuttering.
&#8250;</span></span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Sporadic specifications are preserved in a dilated run.&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>sporadic_sub</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8810; r&#8250;</span></span></span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8712; &#10214;c sporadic &#964; on c&#39;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;r &#8712; &#10214;c sporadic &#964; on c&#39;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>assms</span><span class="delimiter">(</span><span>1</span><span class="delimiter">)</span><span> </span><span>is_subrun_def</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>f</span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;dilating f sub r&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704;n c. time ((Rep_run sub) n c) = time ((Rep_run r) (f n) c)
           &#8743; hamlet ((Rep_run sub) n c) = hamlet ((Rep_run r) (f n) c)&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>dilating_def</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>assms</span><span class="delimiter">(</span><span>2</span><span class="delimiter">)</span><span> </span><span class="keyword1"><span class="command">have</span></span><span>
</span><span>    </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8712; {r. &#8707; n. hamlet ((Rep_run r) n c) &#8743; time ((Rep_run r) n c&#39;) = &#964;}&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>this</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>k</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;time ((Rep_run sub) k c&#39;) = &#964; &#8743; hamlet ((Rep_run sub) k c)&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword1"><span class="command">ultimately</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;time ((Rep_run r) (f k) c&#39;) = &#964; &#8743; hamlet ((Rep_run r) (f k) c)&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Implications are preserved in a dilated run.&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>implies_sub</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8810; r&#8250;</span></span></span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8712; &#10214;c<span class="hidden">&#8681;</span><sub>1</sub> implies c<span class="hidden">&#8681;</span><sub>2</sub>&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;r &#8712; &#10214;c<span class="hidden">&#8681;</span><sub>1</sub> implies c<span class="hidden">&#8681;</span><sub>2</sub>&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>assms</span><span class="delimiter">(</span><span>1</span><span class="delimiter">)</span><span> </span><span>is_subrun_def</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>f</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;dilating f sub r&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>assms</span><span class="delimiter">(</span><span>2</span><span class="delimiter">)</span><span> </span><span class="keyword1"><span class="command">have</span></span><span>
</span><span>    </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8712; {r. &#8704;n. hamlet ((Rep_run r) n c<span class="hidden">&#8681;</span><sub>1</sub>) &#10230; hamlet ((Rep_run r) n c<span class="hidden">&#8681;</span><sub>2</sub>)}&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704;n. hamlet ((Rep_run sub) n c<span class="hidden">&#8681;</span><sub>1</sub>) &#10230; hamlet ((Rep_run sub) n c<span class="hidden">&#8681;</span><sub>2</sub>)&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">ultimately</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704;n. hamlet ((Rep_run r) n c<span class="hidden">&#8681;</span><sub>1</sub>) &#10230; hamlet ((Rep_run r) n c<span class="hidden">&#8681;</span><sub>2</sub>)&#8250;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>ticks_imp_ticks_subk</span><span> </span><span>ticks_sub</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>implies_not_sub</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8810; r&#8250;</span></span></span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8712; &#10214;c<span class="hidden">&#8681;</span><sub>1</sub> implies not c<span class="hidden">&#8681;</span><sub>2</sub>&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;r &#8712; &#10214;c<span class="hidden">&#8681;</span><sub>1</sub> implies not c<span class="hidden">&#8681;</span><sub>2</sub>&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>assms</span><span class="delimiter">(</span><span>1</span><span class="delimiter">)</span><span> </span><span>is_subrun_def</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>f</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;dilating f sub r&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>assms</span><span class="delimiter">(</span><span>2</span><span class="delimiter">)</span><span> </span><span class="keyword1"><span class="command">have</span></span><span>
</span><span>    </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8712; {r. &#8704;n. hamlet ((Rep_run r) n c<span class="hidden">&#8681;</span><sub>1</sub>) &#10230; &#172; hamlet ((Rep_run r) n c<span class="hidden">&#8681;</span><sub>2</sub>)}&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704;n. hamlet ((Rep_run sub) n c<span class="hidden">&#8681;</span><sub>1</sub>) &#10230; &#172; hamlet ((Rep_run sub) n c<span class="hidden">&#8681;</span><sub>2</sub>)&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">ultimately</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704;n. hamlet ((Rep_run r) n c<span class="hidden">&#8681;</span><sub>1</sub>) &#10230; &#172; hamlet ((Rep_run r) n c<span class="hidden">&#8681;</span><sub>2</sub>)&#8250;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>ticks_imp_ticks_subk</span><span> </span><span>ticks_sub</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Precedence relations are preserved in a dilated run.&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>weakly_precedes_sub</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8810; r&#8250;</span></span></span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8712; &#10214;c<span class="hidden">&#8681;</span><sub>1</sub> weakly precedes c<span class="hidden">&#8681;</span><sub>2</sub>&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;r &#8712; &#10214;c<span class="hidden">&#8681;</span><sub>1</sub> weakly precedes c<span class="hidden">&#8681;</span><sub>2</sub>&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>assms</span><span class="delimiter">(</span><span>1</span><span class="delimiter">)</span><span> </span><span>is_subrun_def</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>f</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>*</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;dilating f sub r&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>assms</span><span class="delimiter">(</span><span>2</span><span class="delimiter">)</span><span> </span><span class="keyword1"><span class="command">have</span></span><span>
</span><span>    </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8712; {r. &#8704;n. (run_tick_count r c<span class="hidden">&#8681;</span><sub>2</sub> n) &#8804; (run_tick_count r c<span class="hidden">&#8681;</span><sub>1</sub> n)}&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704;n. (run_tick_count sub c<span class="hidden">&#8681;</span><sub>2</sub> n) &#8804; (run_tick_count sub c<span class="hidden">&#8681;</span><sub>1</sub> n)&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>dil_tick_count</span><span class="delimiter">[</span><span>OF</span><span> </span><span>assms</span><span class="delimiter">(</span><span>1</span><span class="delimiter">)</span><span> </span><span>this</span><span class="delimiter">]</span><span>
</span><span>    </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704;n. (run_tick_count r c<span class="hidden">&#8681;</span><sub>2</sub> n) &#8804; (run_tick_count r c<span class="hidden">&#8681;</span><sub>1</sub> n)&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>strictly_precedes_sub</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8810; r&#8250;</span></span></span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8712; &#10214;c<span class="hidden">&#8681;</span><sub>1</sub> strictly precedes c<span class="hidden">&#8681;</span><sub>2</sub>&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;r &#8712; &#10214;c<span class="hidden">&#8681;</span><sub>1</sub> strictly precedes c<span class="hidden">&#8681;</span><sub>2</sub>&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>assms</span><span class="delimiter">(</span><span>1</span><span class="delimiter">)</span><span> </span><span>is_subrun_def</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>f</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>*</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;dilating f sub r&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>assms</span><span class="delimiter">(</span><span>2</span><span class="delimiter">)</span><span> </span><span class="keyword1"><span class="command">have</span></span><span>
</span><span>    </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8712; { &#961;. &#8704;n::nat. (run_tick_count &#961; c<span class="hidden">&#8681;</span><sub>2</sub> n) &#8804; (run_tick_count_strictly &#961; c<span class="hidden">&#8681;</span><sub>1</sub> n) }&#8250;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>strictly_precedes_alt_def2</span><span class="delimiter">[</span><span>of</span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;c<span class="hidden">&#8681;</span><sub>2</sub>&#8250;</span></span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;c<span class="hidden">&#8681;</span><sub>1</sub>&#8250;</span></span></span><span class="delimiter">]</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span>
</span><span>    </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8712; { &#961;. (&#172;hamlet ((Rep_run &#961;) 0 c<span class="hidden">&#8681;</span><sub>2</sub>))
  &#8743; (&#8704;n::nat. (run_tick_count &#961; c<span class="hidden">&#8681;</span><sub>2</sub> (Suc n)) &#8804; (run_tick_count &#961; c<span class="hidden">&#8681;</span><sub>1</sub> n)) }&#8250;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;(&#172;hamlet ((Rep_run sub) 0 c<span class="hidden">&#8681;</span><sub>2</sub>))
       &#8743; (&#8704;n::nat. (run_tick_count sub c<span class="hidden">&#8681;</span><sub>2</sub> (Suc n)) &#8804; (run_tick_count sub c<span class="hidden">&#8681;</span><sub>1</sub> n))&#8250;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">hence</span></span><span>
</span><span>    </span><span>1</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;(&#172;hamlet ((Rep_run sub) 0 c<span class="hidden">&#8681;</span><sub>2</sub>))
     &#8743; (&#8704;n::nat. (tick_count sub c<span class="hidden">&#8681;</span><sub>2</sub> (Suc n)) &#8804; (tick_count sub c<span class="hidden">&#8681;</span><sub>1</sub> n))&#8250;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>tick_count_is_fun</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704;n::nat. (tick_count r c<span class="hidden">&#8681;</span><sub>2</sub> (Suc n)) &#8804; (tick_count r c<span class="hidden">&#8681;</span><sub>1</sub> n)&#8250;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>    </span><span class="keyword1"><span class="command">{</span></span><span> </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>n</span><span class="delimiter">::</span><span>nat</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;tick_count r c<span class="hidden">&#8681;</span><sub>2</sub> (Suc n) &#8804; tick_count r c<span class="hidden">&#8681;</span><sub>1</sub> n&#8250;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8707;n<span class="hidden">&#8681;</span><sub>0</sub>. f n<span class="hidden">&#8681;</span><sub>0</sub> = n&#8250;</span></span></span><span class="delimiter">)</span><span>
</span><span>        </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span> </span><span class="comment">&#8213; &#8249;n is in the image of f&#8250;</span><span>
</span><span>          </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>this</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>n<span class="hidden">&#8681;</span><sub>0</sub></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>fn</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;f n<span class="hidden">&#8681;</span><sub>0</sub> = n&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>          </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>          </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8707;sn<span class="hidden">&#8681;</span><sub>0</sub>. f sn<span class="hidden">&#8681;</span><sub>0</sub> = Suc n&#8250;</span></span></span><span class="delimiter">)</span><span>
</span><span>            </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span> </span><span class="comment">&#8213; &#8249;Suc n is in the image of f&#8250;</span><span>
</span><span>              </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>this</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>sn<span class="hidden">&#8681;</span><sub>0</sub></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>fsn</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;f sn<span class="hidden">&#8681;</span><sub>0</sub> = Suc n&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>              </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>fn</span><span> </span><span>strict_mono_suc</span><span> </span><span>*</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sn<span class="hidden">&#8681;</span><sub>0</sub> = Suc n<span class="hidden">&#8681;</span><sub>0</sub>&#8250;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>dilating_def</span><span> </span><span>dilating_fun_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>              </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>1</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;tick_count sub c<span class="hidden">&#8681;</span><sub>2</sub> sn<span class="hidden">&#8681;</span><sub>0</sub> &#8804; tick_count sub c<span class="hidden">&#8681;</span><sub>1</sub> n<span class="hidden">&#8681;</span><sub>0</sub>&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>              </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>fn</span><span> </span><span>fsn</span><span> </span><span>tick_count_sub</span><span class="delimiter">[</span><span>OF</span><span> </span><span>*</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>          </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span> </span><span class="comment">&#8213; &#8249;Suc n is not in the image of f&#8250;</span><span>
</span><span>              </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#172;hamlet ((Rep_run r) (Suc n) c<span class="hidden">&#8681;</span><sub>2</sub>)&#8250;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>*</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>dilating_def</span><span> </span><span>dilating_fun_def</span><span class="delimiter">)</span><span>
</span><span>              </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;tick_count r c<span class="hidden">&#8681;</span><sub>2</sub> (Suc n) = tick_count r c<span class="hidden">&#8681;</span><sub>2</sub> n&#8250;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>tick_count_suc</span><span class="delimiter">)</span><span>
</span><span>              </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;... = tick_count sub c<span class="hidden">&#8681;</span><sub>2</sub> n<span class="hidden">&#8681;</span><sub>0</sub>&#8250;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>fn</span><span> </span><span>tick_count_sub</span><span class="delimiter">[</span><span>OF</span><span> </span><span>*</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>              </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;tick_count r c<span class="hidden">&#8681;</span><sub>2</sub> (Suc n) = tick_count sub c<span class="hidden">&#8681;</span><sub>2</sub> n<span class="hidden">&#8681;</span><sub>0</sub>&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;tick_count sub c<span class="hidden">&#8681;</span><sub>2</sub> n<span class="hidden">&#8681;</span><sub>0</sub> &#8804; tick_count sub c<span class="hidden">&#8681;</span><sub>2</sub> (Suc n<span class="hidden">&#8681;</span><sub>0</sub>)&#8250;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>tick_count_suc</span><span class="delimiter">)</span><span>
</span><span>              </span><span class="keyword1"><span class="command">ultimately</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span>
</span><span>                </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;tick_count r c<span class="hidden">&#8681;</span><sub>2</sub> (Suc n) &#8804; tick_count sub c<span class="hidden">&#8681;</span><sub>2</sub> (Suc n<span class="hidden">&#8681;</span><sub>0</sub>)&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>              </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span>
</span><span>                </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;tick_count sub c<span class="hidden">&#8681;</span><sub>2</sub> (Suc n<span class="hidden">&#8681;</span><sub>0</sub>) &#8804; tick_count sub c<span class="hidden">&#8681;</span><sub>1</sub> n<span class="hidden">&#8681;</span><sub>0</sub>&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>              </span><span class="keyword1"><span class="command">ultimately</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;tick_count r c<span class="hidden">&#8681;</span><sub>2</sub> (Suc n) &#8804; tick_count sub c<span class="hidden">&#8681;</span><sub>1</sub> n<span class="hidden">&#8681;</span><sub>0</sub>&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>              </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>tick_count_sub</span><span class="delimiter">[</span><span>OF</span><span> </span><span>*</span><span class="delimiter">]</span><span> </span><span>fn</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>          </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>        </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span> </span><span class="comment">&#8213; &#8249;n is not in the image of f&#8250;</span><span>
</span><span>          </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>greatest_prev_image</span><span class="delimiter">[</span><span>OF</span><span> </span><span>*</span><span> </span><span>this</span><span class="delimiter">]</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>n<span class="hidden">&#8681;</span><sub>p</sub></span><span>  </span><span class="keyword2"><span class="keyword">where</span></span><span>
</span><span>            </span><span>np_prop</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;f n<span class="hidden">&#8681;</span><sub>p</sub> &lt; n &#8743; (&#8704;k. f n<span class="hidden">&#8681;</span><sub>p</sub> &lt; k &#8743; k &#8804; n &#10230; (&#8708;k<span class="hidden">&#8681;</span><sub>0</sub>. f k<span class="hidden">&#8681;</span><sub>0</sub> = k))&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>          </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>tick_count_latest</span><span class="delimiter">[</span><span>OF</span><span> </span><span>*</span><span> </span><span>this</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">have</span></span><span>
</span><span>            </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;tick_count r c<span class="hidden">&#8681;</span><sub>1</sub> n = tick_count r c<span class="hidden">&#8681;</span><sub>1</sub> (f n<span class="hidden">&#8681;</span><sub>p</sub>)&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span> 
</span><span>          </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span>a</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;tick_count r c<span class="hidden">&#8681;</span><sub>1</sub> n = tick_count sub c<span class="hidden">&#8681;</span><sub>1</sub> n<span class="hidden">&#8681;</span><sub>p</sub>&#8250;</span></span></span><span>
</span><span>            </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>tick_count_sub</span><span class="delimiter">[</span><span>OF</span><span> </span><span>*</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>          </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>b</span><span class="delimiter">:</span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;tick_count sub c<span class="hidden">&#8681;</span><sub>2</sub> (Suc n<span class="hidden">&#8681;</span><sub>p</sub>) &#8804; tick_count sub c<span class="hidden">&#8681;</span><sub>1</sub> n<span class="hidden">&#8681;</span><sub>p</sub>&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>          </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>          </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8707;sn<span class="hidden">&#8681;</span><sub>0</sub>. f sn<span class="hidden">&#8681;</span><sub>0</sub> = Suc n&#8250;</span></span></span><span class="delimiter">)</span><span>
</span><span>            </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span> </span><span class="comment">&#8213; &#8249;Suc n is in the image of f&#8250;</span><span>
</span><span>              </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>this</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>sn<span class="hidden">&#8681;</span><sub>0</sub></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>fsn</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;f sn<span class="hidden">&#8681;</span><sub>0</sub> = Suc n&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>              </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>next_non_stuttering</span><span class="delimiter">[</span><span>OF</span><span> </span><span>*</span><span> </span><span>np_prop</span><span> </span><span>this</span><span class="delimiter">]</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>sn_prop</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sn<span class="hidden">&#8681;</span><sub>0</sub> = Suc n<span class="hidden">&#8681;</span><sub>p</sub>&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>b</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;tick_count sub c<span class="hidden">&#8681;</span><sub>2</sub> sn<span class="hidden">&#8681;</span><sub>0</sub> &#8804; tick_count sub c<span class="hidden">&#8681;</span><sub>1</sub> n<span class="hidden">&#8681;</span><sub>p</sub>&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>              </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>tick_count_sub</span><span class="delimiter">[</span><span>OF</span><span> </span><span>*</span><span class="delimiter">]</span><span> </span><span>fsn</span><span> </span><span>a</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>          </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span> </span><span class="comment">&#8213; &#8249;Suc n is not in the image of f&#8250;</span><span>
</span><span>              </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#172;hamlet ((Rep_run r) (Suc n) c<span class="hidden">&#8681;</span><sub>2</sub>)&#8250;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>*</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>dilating_def</span><span> </span><span>dilating_fun_def</span><span class="delimiter">)</span><span>
</span><span>              </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;tick_count r c<span class="hidden">&#8681;</span><sub>2</sub> (Suc n) = tick_count r c<span class="hidden">&#8681;</span><sub>2</sub> n&#8250;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>tick_count_suc</span><span class="delimiter">)</span><span>
</span><span>              </span><span class="keyword1"><span class="command">also</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;... = tick_count sub c<span class="hidden">&#8681;</span><sub>2</sub> n<span class="hidden">&#8681;</span><sub>p</sub>&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>np_prop</span><span> </span><span>tick_count_sub</span><span class="delimiter">[</span><span>OF</span><span> </span><span>*</span><span class="delimiter">]</span><span>
</span><span>                </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>tick_count_latest</span><span class="delimiter">[</span><span>OF</span><span> </span><span>*</span><span> </span><span>np_prop</span><span class="delimiter">]</span><span class="delimiter">)</span><span>
</span><span>              </span><span class="keyword1"><span class="command">finally</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;tick_count r c<span class="hidden">&#8681;</span><sub>2</sub> (Suc n) = tick_count sub c<span class="hidden">&#8681;</span><sub>2</sub> n<span class="hidden">&#8681;</span><sub>p</sub>&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;tick_count sub c<span class="hidden">&#8681;</span><sub>2</sub> n<span class="hidden">&#8681;</span><sub>p</sub> &#8804; tick_count sub c<span class="hidden">&#8681;</span><sub>2</sub> (Suc n<span class="hidden">&#8681;</span><sub>p</sub>)&#8250;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>tick_count_suc</span><span class="delimiter">)</span><span>
</span><span>              </span><span class="keyword1"><span class="command">ultimately</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span>
</span><span>                </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;tick_count r c<span class="hidden">&#8681;</span><sub>2</sub> (Suc n) &#8804; tick_count sub c<span class="hidden">&#8681;</span><sub>2</sub> (Suc n<span class="hidden">&#8681;</span><sub>p</sub>)&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>              </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span>
</span><span>                </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;tick_count sub c<span class="hidden">&#8681;</span><sub>2</sub> (Suc n<span class="hidden">&#8681;</span><sub>p</sub>) &#8804; tick_count sub c<span class="hidden">&#8681;</span><sub>1</sub> n<span class="hidden">&#8681;</span><sub>p</sub>&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>1</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>              </span><span class="keyword1"><span class="command">ultimately</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;tick_count r c<span class="hidden">&#8681;</span><sub>2</sub> (Suc n) &#8804; tick_count sub c<span class="hidden">&#8681;</span><sub>1</sub> n<span class="hidden">&#8681;</span><sub>p</sub>&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>              </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>np_prop</span><span> </span><span>mono_tick_count</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>a</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>linarith</span><span>
</span><span>          </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">}</span></span><span> </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">..</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>1</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#172;hamlet ((Rep_run r) 0 c<span class="hidden">&#8681;</span><sub>2</sub>)&#8250;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>*</span><span> </span><span>empty_dilated_prefix</span><span> </span><span>ticks_sub</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>  </span><span class="keyword1"><span class="command">ultimately</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>tick_count_is_fun</span><span> </span><span>strictly_precedes_alt_def2</span><span class="delimiter">)</span><span> 
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;
  Time delayed relations are preserved in a dilated run.
&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>time_delayed_sub</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8810; r&#8250;</span></span></span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8712; &#10214; a time-delayed by &#948;&#964; on ms implies b &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;r &#8712; &#10214; a time-delayed by &#948;&#964; on ms implies b &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>assms</span><span class="delimiter">(</span><span>1</span><span class="delimiter">)</span><span> </span><span>is_subrun_def</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>f</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>*</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;dilating f sub r&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>assms</span><span class="delimiter">(</span><span>2</span><span class="delimiter">)</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704;n. hamlet ((Rep_run sub) n a)
                          &#10230; (&#8704;m &#8805; n. first_time sub ms m (time ((Rep_run sub) n ms) + &#948;&#964;)
                                       &#10230; hamlet ((Rep_run sub) m b))&#8250;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>TESL_interpretation_atomic.simps</span><span class="delimiter">(</span><span>5</span><span class="delimiter">)</span><span class="delimiter">[</span><span>of</span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;a&#8250;</span></span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#948;&#964;&#8250;</span></span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;ms&#8250;</span></span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;b&#8250;</span></span></span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span>**</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704;n<span class="hidden">&#8681;</span><sub>0</sub>. hamlet ((Rep_run r) (f n<span class="hidden">&#8681;</span><sub>0</sub>) a)
                  &#10230; (&#8704;m<span class="hidden">&#8681;</span><sub>0</sub> &#8805; n<span class="hidden">&#8681;</span><sub>0</sub>. first_time r ms (f m<span class="hidden">&#8681;</span><sub>0</sub>) (time ((Rep_run r) (f n<span class="hidden">&#8681;</span><sub>0</sub>) ms) + &#948;&#964;)
                                  &#10230; hamlet ((Rep_run r) (f m<span class="hidden">&#8681;</span><sub>0</sub>) b))  &#8250;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>first_time_image</span><span class="delimiter">[</span><span>OF</span><span> </span><span>*</span><span class="delimiter">]</span><span> </span><span>dilating_def</span><span> </span><span>*</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>  </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704;n. hamlet ((Rep_run r) n a)
                  &#10230; (&#8704;m &#8805; n. first_time r ms m (time ((Rep_run r) n ms) + &#948;&#964;)
                                &#10230; hamlet ((Rep_run r) m b))&#8250;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>    </span><span class="keyword1"><span class="command">{</span></span><span> </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>n</span><span> </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>assm</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;hamlet ((Rep_run r) n a)&#8250;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>ticks_image_sub</span><span class="delimiter">[</span><span>OF</span><span> </span><span>*</span><span> </span><span>assm</span><span class="delimiter">]</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>n<span class="hidden">&#8681;</span><sub>0</sub></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>nfn0</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;n = f n<span class="hidden">&#8681;</span><sub>0</sub>&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>      </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>**</span><span> </span><span>assm</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>ft0</span><span class="delimiter">:</span><span>
</span><span>        </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;(&#8704;m<span class="hidden">&#8681;</span><sub>0</sub> &#8805; n<span class="hidden">&#8681;</span><sub>0</sub>. first_time r ms (f m<span class="hidden">&#8681;</span><sub>0</sub>) (time ((Rep_run r) (f n<span class="hidden">&#8681;</span><sub>0</sub>) ms) + &#948;&#964;)
                    &#10230; hamlet ((Rep_run r) (f m<span class="hidden">&#8681;</span><sub>0</sub>) b))&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;(&#8704;m &#8805; n. first_time r ms m (time ((Rep_run r) n ms) + &#948;&#964;) 
                       &#10230; hamlet ((Rep_run r) m b)) &#8250;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>      </span><span class="keyword1"><span class="command">{</span></span><span> </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>m</span><span> </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>hyp</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;m &#8805; n&#8250;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;first_time r ms m (time (Rep_run r n ms) + &#948;&#964;) &#10230; hamlet (Rep_run r m b)&#8250;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8707;m<span class="hidden">&#8681;</span><sub>0</sub>. f m<span class="hidden">&#8681;</span><sub>0</sub> = m&#8250;</span></span></span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>          </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>this</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>m<span class="hidden">&#8681;</span><sub>0</sub></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;m = f m<span class="hidden">&#8681;</span><sub>0</sub>&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>          </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;strict_mono f&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>*</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>dilating_def</span><span> </span><span>dilating_fun_def</span><span class="delimiter">)</span><span>
</span><span>          </span><span class="keyword1"><span class="command">ultimately</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>ft0</span><span> </span><span>hyp</span><span> </span><span>nfn0</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>strict_mono_less_eq</span><span class="delimiter">)</span><span>
</span><span>        </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>          </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span> </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>          </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;m = 0&#8250;</span></span></span><span class="delimiter">)</span><span>
</span><span>            </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>              </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;m = f 0&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>*</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>dilating_def</span><span> </span><span>dilating_fun_def</span><span class="delimiter">)</span><span>
</span><span>              </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>False</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>          </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span>
</span><span>            </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8707;pm. m = Suc pm&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>not0_implies_Suc</span><span class="delimiter">)</span><span>
</span><span>            </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>this</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>pm</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>mpm</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;m = Suc pm&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>            </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8708;pm<span class="hidden">&#8681;</span><sub>0</sub>. f pm<span class="hidden">&#8681;</span><sub>0</sub> = Suc pm&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8708;m<span class="hidden">&#8681;</span><sub>0</sub>. f m<span class="hidden">&#8681;</span><sub>0</sub> = m&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span> 
</span><span>            </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>*</span><span>  </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;time (Rep_run r (Suc pm) ms) = time (Rep_run r pm ms)&#8250;</span></span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>dilating_def</span><span> </span><span>dilating_fun_def</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>            </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;time (Rep_run r pm ms) = time (Rep_run r m ms)&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>mpm</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>            </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>mpm</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;pm &lt; m&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>            </span><span class="keyword1"><span class="command">ultimately</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8707;m&#39; &lt; m. time (Rep_run r m&#39; ms) = time (Rep_run r m ms)&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>            </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#172;(first_time r ms m (time (Rep_run r n ms) + &#948;&#964;))&#8250;</span></span></span><span>
</span><span>              </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>auto</span><span> </span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>first_time_def</span><span class="delimiter">)</span><span>
</span><span>            </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>          </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">}</span></span><span> </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">}</span></span><span> </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Time relations are preserved through dilation of a run.&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>tagrel_sub&#39;</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8810; r&#8250;</span></span></span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8712; &#10214; time-relation &#8970;c<span class="hidden">&#8681;</span><sub>1</sub>,c<span class="hidden">&#8681;</span><sub>2</sub>&#8971; &#8712; R &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;R (time ((Rep_run r) n c<span class="hidden">&#8681;</span><sub>1</sub>), time ((Rep_run r) n c<span class="hidden">&#8681;</span><sub>2</sub>))&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>assms</span><span class="delimiter">(</span><span>1</span><span class="delimiter">)</span><span> </span><span>is_subrun_def</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>f</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>*</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;dilating f sub r&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>assms</span><span class="delimiter">(</span><span>2</span><span class="delimiter">)</span><span> </span><span>TESL_interpretation_atomic.simps</span><span class="delimiter">(</span><span>2</span><span class="delimiter">)</span><span> </span><span class="keyword1"><span class="command">have</span></span><span>
</span><span>    </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8712; {r. &#8704;n. R (time ((Rep_run r) n c<span class="hidden">&#8681;</span><sub>1</sub>), time ((Rep_run r) n c<span class="hidden">&#8681;</span><sub>2</sub>))}&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span>1</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704;n. R (time ((Rep_run sub) n c<span class="hidden">&#8681;</span><sub>1</sub>), time ((Rep_run sub) n c<span class="hidden">&#8681;</span><sub>2</sub>))&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>induction</span><span> </span><span>n</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>0</span><span>
</span><span>      </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>1</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;R (time ((Rep_run sub) 0 c<span class="hidden">&#8681;</span><sub>1</sub>), time ((Rep_run sub) 0 c<span class="hidden">&#8681;</span><sub>2</sub>))&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>      </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>*</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;f 0 = 0&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>dilating_def</span><span> </span><span>dilating_fun_def</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>*</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704;c. time ((Rep_run sub) 0 c) = time ((Rep_run r) (f 0) c)&#8250;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>dilating_def</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">ultimately</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>    </span><span class="keyword3"><span class="command">case</span></span><span> </span><span class="delimiter">(</span><span>Suc</span><span> </span><span>n</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">then</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span>
</span><span>    </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8708;n<span class="hidden">&#8681;</span><sub>0</sub>. f n<span class="hidden">&#8681;</span><sub>0</sub> = Suc n&#8250;</span></span></span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>      </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>*</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704;c. time (Rep_run r (Suc n) c) = time (Rep_run r n c)&#8250;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>dilating_def</span><span> </span><span>dilating_fun_def</span><span class="delimiter">)</span><span> 
</span><span>      </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>Suc.IH</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>    </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>      </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span>
</span><span>      </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>this</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>n<span class="hidden">&#8681;</span><sub>0</sub></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>n<span class="hidden">&#8681;</span><sub>0</sub>prop</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;f n<span class="hidden">&#8681;</span><sub>0</sub> = Suc n&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>      </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>1</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;R (time ((Rep_run sub) n<span class="hidden">&#8681;</span><sub>0</sub> c<span class="hidden">&#8681;</span><sub>1</sub>), time ((Rep_run sub) n<span class="hidden">&#8681;</span><sub>0</sub> c<span class="hidden">&#8681;</span><sub>2</sub>))&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>      </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>n<span class="hidden">&#8681;</span><sub>0</sub>prop</span><span> </span><span>*</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;time ((Rep_run sub) n<span class="hidden">&#8681;</span><sub>0</sub> c<span class="hidden">&#8681;</span><sub>1</sub>) = time ((Rep_run r) (Suc n) c<span class="hidden">&#8681;</span><sub>1</sub>)&#8250;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>dilating_def</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>n<span class="hidden">&#8681;</span><sub>0</sub>prop</span><span> </span><span>*</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;time ((Rep_run sub) n<span class="hidden">&#8681;</span><sub>0</sub> c<span class="hidden">&#8681;</span><sub>2</sub>) = time ((Rep_run r) (Suc n) c<span class="hidden">&#8681;</span><sub>2</sub>)&#8250;</span></span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>simp</span><span> </span><span>add</span><span class="delimiter">:</span><span> </span><span>dilating_def</span><span class="delimiter">)</span><span>
</span><span>      </span><span class="keyword1"><span class="command">ultimately</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>    </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">corollary</span></span><span> </span><span>tagrel_sub</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8810; r&#8250;</span></span></span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8712; &#10214; time-relation &#8970;c<span class="hidden">&#8681;</span><sub>1</sub>,c<span class="hidden">&#8681;</span><sub>2</sub>&#8971; &#8712; R &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;r &#8712; &#10214; time-relation &#8970;c<span class="hidden">&#8681;</span><sub>1</sub>,c<span class="hidden">&#8681;</span><sub>2</sub>&#8971; &#8712; R &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">using</span></span><span> </span><span>tagrel_sub&#39;</span><span class="delimiter">[</span><span>OF</span><span> </span><span>assms</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">unfolding</span></span><span> </span><span>TESL_interpretation_atomic.simps</span><span class="delimiter">(</span><span>3</span><span class="delimiter">)</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;Time relations are also preserved by contraction&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>tagrel_sub_inv</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8810; r&#8250;</span></span></span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;r &#8712; &#10214; time-relation &#8970;c<span class="hidden">&#8681;</span><sub>1</sub>, c<span class="hidden">&#8681;</span><sub>2</sub>&#8971; &#8712; R &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8712; &#10214; time-relation &#8970;c<span class="hidden">&#8681;</span><sub>1</sub>, c<span class="hidden">&#8681;</span><sub>2</sub>&#8971; &#8712; R &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>assms</span><span class="delimiter">(</span><span>1</span><span class="delimiter">)</span><span> </span><span>is_subrun_def</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>f</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>df</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;dilating f sub r&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>assms</span><span class="delimiter">(</span><span>2</span><span class="delimiter">)</span><span> </span><span>TESL_interpretation_atomic.simps</span><span class="delimiter">(</span><span>2</span><span class="delimiter">)</span><span> </span><span class="keyword1"><span class="command">have</span></span><span>
</span><span>    </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;r &#8712; {&#961;. &#8704;n. R (time ((Rep_run &#961;) n c<span class="hidden">&#8681;</span><sub>1</sub>), time ((Rep_run &#961;) n c<span class="hidden">&#8681;</span><sub>2</sub>))}&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704;n. R (time ((Rep_run r) n c<span class="hidden">&#8681;</span><sub>1</sub>), time ((Rep_run r) n c<span class="hidden">&#8681;</span><sub>2</sub>))&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704;n. (&#8707;n<span class="hidden">&#8681;</span><sub>0</sub>. f n<span class="hidden">&#8681;</span><sub>0</sub> = n) &#10230; R (time ((Rep_run r) n c<span class="hidden">&#8681;</span><sub>1</sub>), time ((Rep_run r) n c<span class="hidden">&#8681;</span><sub>2</sub>))&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704;n<span class="hidden">&#8681;</span><sub>0</sub>. R (time ((Rep_run r) (f n<span class="hidden">&#8681;</span><sub>0</sub>) c<span class="hidden">&#8681;</span><sub>1</sub>), time ((Rep_run r) (f n<span class="hidden">&#8681;</span><sub>0</sub>) c<span class="hidden">&#8681;</span><sub>2</sub>))&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>dilating_def</span><span> </span><span>df</span><span> </span><span class="keyword1"><span class="command">have</span></span><span>
</span><span>    </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704;n c. time ((Rep_run sub) n c) = time ((Rep_run r) (f n) c)&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">ultimately</span></span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704;n<span class="hidden">&#8681;</span><sub>0</sub>. R (time ((Rep_run sub) n<span class="hidden">&#8681;</span><sub>0</sub> c<span class="hidden">&#8681;</span><sub>1</sub>), time ((Rep_run sub) n<span class="hidden">&#8681;</span><sub>0</sub> c<span class="hidden">&#8681;</span><sub>2</sub>))&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>auto</span><span>
</span><span>  </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;
  Kill relations are preserved in a dilated run.
&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>kill_sub</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8810; r&#8250;</span></span></span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8712; &#10214; c<span class="hidden">&#8681;</span><sub>1</sub> kills c<span class="hidden">&#8681;</span><sub>2</sub> &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;r &#8712; &#10214; c<span class="hidden">&#8681;</span><sub>1</sub> kills c<span class="hidden">&#8681;</span><sub>2</sub> &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>assms</span><span class="delimiter">(</span><span>1</span><span class="delimiter">)</span><span> </span><span>is_subrun_def</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>f</span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>*</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;dilating f sub r&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>assms</span><span class="delimiter">(</span><span>2</span><span class="delimiter">)</span><span> </span><span>TESL_interpretation_atomic.simps</span><span class="delimiter">(</span><span>8</span><span class="delimiter">)</span><span> </span><span class="keyword1"><span class="command">have</span></span><span>
</span><span>    </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704;n. hamlet (Rep_run sub n c<span class="hidden">&#8681;</span><sub>1</sub>) &#10230; (&#8704;m&#8805;n. &#172; hamlet (Rep_run sub m c<span class="hidden">&#8681;</span><sub>2</sub>))&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span>1</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704;n. hamlet (Rep_run r (f n) c<span class="hidden">&#8681;</span><sub>1</sub>) &#10230; (&#8704;m&#8805;n. &#172; hamlet (Rep_run r (f m) c<span class="hidden">&#8681;</span><sub>2</sub>))&#8250;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>ticks_sub</span><span class="delimiter">[</span><span>OF</span><span> </span><span>*</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704;n. hamlet (Rep_run r (f n) c<span class="hidden">&#8681;</span><sub>1</sub>) &#10230; (&#8704;m&#8805; (f n). &#172; hamlet (Rep_run r m c<span class="hidden">&#8681;</span><sub>2</sub>))&#8250;</span></span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>    </span><span class="keyword1"><span class="command">{</span></span><span> </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>n</span><span> </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;hamlet (Rep_run r (f n) c<span class="hidden">&#8681;</span><sub>1</sub>)&#8250;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>1</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>2</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704; m &#8805; n. &#172; hamlet (Rep_run r (f m) c<span class="hidden">&#8681;</span><sub>2</sub>)&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>      </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704; m&#8805; (f n). &#172; hamlet (Rep_run r m c<span class="hidden">&#8681;</span><sub>2</sub>)&#8250;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span>-</span><span>
</span><span>        </span><span class="keyword1"><span class="command">{</span></span><span> </span><span class="keyword3"><span class="command">fix</span></span><span> </span><span>m</span><span> </span><span class="keyword3"><span class="command">assume</span></span><span> </span><span>h</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;m &#8805; f n&#8250;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#172; hamlet (Rep_run r m c<span class="hidden">&#8681;</span><sub>2</sub>)&#8250;</span></span></span><span>
</span><span>          </span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8707;m<span class="hidden">&#8681;</span><sub>0</sub>. f m<span class="hidden">&#8681;</span><sub>0</sub> = m&#8250;</span></span></span><span class="delimiter">)</span><span>
</span><span>            </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>True</span><span>
</span><span>              </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>this</span><span> </span><span class="keyword3"><span class="command">obtain</span></span><span> </span><span>m<span class="hidden">&#8681;</span><sub>0</sub></span><span> </span><span class="keyword2"><span class="keyword">where</span></span><span> </span><span>fm0</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;f m<span class="hidden">&#8681;</span><sub>0</sub> = m&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>              </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;m<span class="hidden">&#8681;</span><sub>0</sub> &#8805; n&#8250;</span></span></span><span>
</span><span>                </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>*</span><span> </span><span>dilating_def</span><span> </span><span>dilating_fun_def</span><span> </span><span>h</span><span> </span><span>strict_mono_less_eq</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>fastforce</span><span>
</span><span>              </span><span class="keyword1"><span class="command">with</span></span><span> </span><span>2</span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>fm0</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>          </span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>            </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>False</span><span>
</span><span>              </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span>  </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>ticks_image_sub&#39;</span><span class="delimiter">[</span><span>OF</span><span> </span><span>*</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>          </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>        </span><span class="keyword1"><span class="command">}</span></span><span> </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>      </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">}</span></span><span> </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span>  </span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>  </span><span class="keyword1"><span class="command">hence</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;&#8704;n. hamlet (Rep_run r n c<span class="hidden">&#8681;</span><sub>1</sub>) &#10230; (&#8704;m &#8805; n. &#172; hamlet (Rep_run r m c<span class="hidden">&#8681;</span><sub>2</sub>))&#8250;</span></span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>ticks_imp_ticks_subk</span><span class="delimiter">[</span><span>OF</span><span> </span><span>*</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span>  </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?thesis</span><span> </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>TESL_interpretation_atomic.simps</span><span class="delimiter">(</span><span>8</span><span class="delimiter">)</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>blast</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword1"><span class="command">lemmas</span></span><span> </span><span>atomic_sub_lemmas</span><span> </span><span class="delimiter">=</span><span> </span><span>sporadic_sub</span><span> </span><span>tagrel_sub</span><span> </span><span>implies_sub</span><span> </span><span>implies_not_sub</span><span>
</span><span>                           </span><span>time_delayed_sub</span><span> </span><span>weakly_precedes_sub</span><span>
</span><span>                           </span><span>strictly_precedes_sub</span><span> </span><span>kill_sub</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;
  We can now prove that all atomic specification formulae are preserved
  by the dilation of runs.
&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">lemma</span></span><span> </span><span>atomic_sub</span><span class="delimiter">:</span><span> 
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8810; r&#8250;</span></span></span><span>
</span><span>      </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8712; &#10214; &#966; &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;r &#8712; &#10214; &#966; &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">using</span></span><span> </span><span>assms</span><span class="delimiter">(</span><span>2</span><span class="delimiter">)</span><span> </span><span>atomic_sub_lemmas</span><span class="delimiter">[</span><span>OF</span><span> </span><span>assms</span><span class="delimiter">(</span><span>1</span><span class="delimiter">)</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span class="delimiter">(</span><span>cases</span><span> </span><span>&#966;</span><span class="delimiter">,</span><span> </span><span>simp_all</span><span class="delimiter">)</span><span>
</span><span>
</span><span class="keyword1"><span class="command">text</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;
  Finally, any TESL specification is invariant by stuttering.
&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">theorem</span></span><span> </span><span>TESL_stuttering_invariant</span><span class="delimiter">:</span><span>
</span><span>  </span><span class="keyword2"><span class="keyword">assumes</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8810; r&#8250;</span></span></span><span>
</span><span>    </span><span class="keyword2"><span class="keyword">shows</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8712; &#10214;&#10214; S &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub> &#10233; r &#8712; &#10214;&#10214; S &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span>
</span><span class="keyword1"><span class="command">proof</span></span><span> </span><span class="delimiter">(</span><span>induction</span><span> </span><span>S</span><span class="delimiter">)</span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span>Nil</span><span>
</span><span>    </span><span class="keyword3"><span class="command">thus</span></span><span> </span><span class="var">?case</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">next</span></span><span>
</span><span>  </span><span class="keyword3"><span class="command">case</span></span><span> </span><span class="delimiter">(</span><span>Cons</span><span> </span><span>a</span><span> </span><span>s</span><span class="delimiter">)</span><span>
</span><span>    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>Cons.prems</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span>sa</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8712; &#10214; a &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span> </span><span class="keyword2"><span class="keyword">and</span></span><span> </span><span>sb</span><span class="delimiter">:</span><span class="cartouche"><span class="delete"><span class="delete">&#8249;sub &#8712; &#10214;&#10214; s &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span>
</span><span>      </span><span class="keyword1"><span class="command">using</span></span><span> </span><span>TESL_interpretation_image</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span class="delimiter">+</span><span>
</span><span>    </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>Cons.IH</span><span class="delimiter">[</span><span>OF</span><span> </span><span>sb</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;r &#8712; &#10214;&#10214; s &#10215;&#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">moreover</span></span><span> </span><span class="keyword1"><span class="command">from</span></span><span> </span><span>atomic_sub</span><span class="delimiter">[</span><span>OF</span><span> </span><span>assms</span><span class="delimiter">(</span><span>1</span><span class="delimiter">)</span><span> </span><span>sa</span><span class="delimiter">]</span><span> </span><span class="keyword1"><span class="command">have</span></span><span> </span><span class="cartouche"><span class="delete"><span class="delete">&#8249;r &#8712; &#10214; a &#10215;<span class="hidden">&#8681;</span><sub>T</sub><span class="hidden">&#8681;</span><sub>E</sub><span class="hidden">&#8681;</span><sub>S</sub><span class="hidden">&#8681;</span><sub>L</sub>&#8250;</span></span></span><span> </span><span class="keyword1"><span class="command">.</span></span><span>
</span><span>    </span><span class="keyword1"><span class="command">ultimately</span></span><span> </span><span class="keyword3"><span class="command">show</span></span><span> </span><span class="var">?case</span><span> </span><span class="keyword1"><span class="command">using</span></span><span>  </span><span>TESL_interpretation_image</span><span> </span><span class="keyword1"><span class="command">by</span></span><span> </span><span>simp</span><span>
</span><span class="keyword1"><span class="command">qed</span></span><span>
</span><span>
</span><span class="keyword2"><span class="keyword">end</span></span><span>
</span></pre>

</div>
</body>
</html>
